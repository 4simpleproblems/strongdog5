var He=Object.defineProperty,Ye=Object.defineProperties;var Ze=Object.getOwnPropertyDescriptors;var Le=Object.getOwnPropertySymbols;var Xe=Object.prototype.hasOwnProperty,qe=Object.prototype.propertyIsEnumerable;var de=(y,e,t)=>e in y?He(y,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):y[e]=t,$e=(y,e)=>{for(var t in e||(e={}))Xe.call(e,t)&&de(y,t,e[t]);if(Le)for(var t of Le(e))qe.call(e,t)&&de(y,t,e[t]);return y},We=(y,e)=>Ye(y,Ze(e));var T=(y,e,t)=>(de(y,typeof e!="symbol"?e+"":e,t),t);var C=(y,e,t)=>new Promise((n,i)=>{var r=u=>{try{l(t.next(u))}catch(m){i(m)}},h=u=>{try{l(t.throw(u))}catch(m){i(m)}},l=u=>u.done?n(u.value):Promise.resolve(u.value).then(r,h);l((t=t.apply(y,e)).next())});import{_ as Ve}from"./BaseButton-t8k10qap.js";import{_ as se}from"./CloseBtn-DIPHiQhk.js";import{_ as Ce}from"./ThreeDText-DWiM50LY.js";import{_ as Q,b as q,a as ae,o as v,c as A,l as M,d as a,e as s,F as J,r as _e,f as N,S as Je,t as S,H as U,w as G,j as Se,u as re,U as Qe,v as R,k as Oe,G as fe,n as F,O as et,E as O,M as Fe,p as Me,q as ke,V as tt,J as st,x as Re,W as Te,X as at,Y as ie,Z as ot,$ as nt,a0 as rt,i as Ae,a1 as Ue,a2 as it,K as ee,m as De,a3 as c,y as Ge,z as ct,a4 as Ee,h as j,L as lt,a5 as dt,N as Ie,P as oe,T as H,Q as Ke,a6 as x,a7 as Y,a8 as ge,A as mt,a9 as z,aa as ut,C as ht}from"./index-BszMCtG6.js";import{_ as xe}from"./LoadingElement-BTdqt7e_.js";import{_ as pt}from"./TwoXRewards-CGaHQEO0.js";import{_ as yt}from"./BaseTextInput-C6zeoAQa.js";import{_ as _t}from"./Settings-Fm64d3ws.js";import{_ as ft}from"./Article-CdTVFKsX.js";import{E as gt,S as bt}from"./mr-eventemitter.min-kzNXp-Xq.js";import{E as L,V as w,a as je,b as be,M as me,P as ue,S as he,D as pe,R as Z,s as ve,L as ye,C as vt,A as wt,c as D,B as St,d as Mt,e as kt,f as Tt,N as Pe,F as At,g as Et,h as xt,W as Lt,i as $t,j as Wt,k as Ne,l as It,m as Pt,n as Nt}from"./ResourceLoader-DSKOvWHX.js";import{L as Bt}from"./LRenderingSystem-DLg3TwNT.js";import{G as Vt}from"./OrbitControlsSystem-uYz8zjvc.js";import{L as ne}from"./LResponsiveCameraSystem-0JRIj-uC.js";import{LPlayersSystem as V}from"./LPlayersSystem-Csiw8JKf.js";import{c as Be}from"./characterSkins-CRh1cnQq.js";import"./EmissionText-CS4IA50y.js";import"./loadout-BvPo_gCl.js";const Ct={class:"reward-view"},Ot={class:"cards"},Ft=["src"],Rt=["src"],Ut={class:"rarity"},Dt={class:"name"},Gt={__name:"RewardView",setup(y){const e=q(),t=ae(),n=e.modalProps["reward-view"].skins;return(i,r)=>{const h=Ce,l=se,u=Ve;return v(),A("div",Ct,[M(h,{text:"DAILY REWARDS",class:"title"}),M(l,{onMouseenter:r[0]||(r[0]=m=>a(t).playInterfaceSoundByName("hover")),onClick:r[1]||(r[1]=m=>(a(e).closeModal("daily-rewards"),a(t).playInterfaceSoundByName("click")))}),s("div",Ot,[(v(!0),A(J,null,_e(a(n),(m,_)=>(v(),A("div",{key:_,class:"card"},[s("img",{src:a(N)["interface/store/skinRarityBg/"+a(Je)[m.rarity].rarity+".svg"],class:"rarity-bg"},null,8,Ft),s("img",{class:"gun-img",src:a(N)["game/weapons/"+m.weaponName+"/skins/"+m.name+"/render.webp"]},null,8,Rt),s("div",Ut,S(m.rarity),1),s("div",Dt,S(m.name),1)]))),128))]),M(u,{onClick:r[2]||(r[2]=m=>a(e).closeModal("reward-view")),class:"accept"},{default:U(()=>[G("ACCEPT")]),_:1})])}}},Kt=Q(Gt,[["__scopeId","data-v-4ec86b99"]]),P=y=>(Me("data-v-8af2b466"),y=y(),ke(),y),jt={class:"daily-rewards"},zt=P(()=>s("div",{class:"hr"},[s("div",{class:"hr-line"})],-1)),Ht=P(()=>s("img",{src:tt,class:"bg"},null,-1)),Yt={class:"content"},Zt={class:"text-cont"},Xt={class:"desc"},qt={class:"rewards"},Jt=st('<g filter="url(#filter0_d_7335_2937)" data-v-8af2b466><path d="M33 0L62.4449 28.2651H3.55514L33 0Z" fill="#EFDC30" data-v-8af2b466></path><path d="M6.04091 27.2651L33 1.38617L59.9591 27.2651H6.04091Z" stroke="#7A6E07" stroke-width="2" data-v-8af2b466></path></g><defs data-v-8af2b466><filter id="filter0_d_7335_2937" x="0.278067" y="0" width="65.4439" height="34.8198" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB" data-v-8af2b466><feFlood flood-opacity="0" result="BackgroundImageFix" data-v-8af2b466></feFlood><feColorMatrix in="SourceAlpha" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" data-v-8af2b466></feColorMatrix><feOffset dy="3.27711" data-v-8af2b466></feOffset><feGaussianBlur stdDeviation="1.63855" data-v-8af2b466></feGaussianBlur><feComposite in2="hardAlpha" operator="out" data-v-8af2b466></feComposite><feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.25 0" data-v-8af2b466></feColorMatrix><feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_7335_2937" data-v-8af2b466></feBlend><feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_7335_2937" result="shape" data-v-8af2b466></feBlend></filter></defs>',2),Qt=[Jt],es={class:"day"},ts={class:"name"},ss=P(()=>s("img",{class:"currency",src:Re},null,-1)),as=P(()=>s("div",{class:"value"},[G("50 "),s("span",{class:"x"},"x")],-1)),os={class:"day"},ns=P(()=>s("img",{class:"random-skin",src:Te},null,-1)),rs=P(()=>s("img",{class:"skin-bg",src:at},null,-1)),is={class:"skin-text"},cs={class:"day"},ls={class:"name"},ds=P(()=>s("img",{class:"currency",src:ie},null,-1)),ms=P(()=>s("div",{class:"value"},[G("20 "),s("span",{class:"x"},"x")],-1)),us={class:"day"},hs=P(()=>s("img",{class:"random-skin",src:Te},null,-1)),ps=P(()=>s("img",{class:"skin-bg",src:ot},null,-1)),ys={class:"skin-text"},_s={class:"day"},fs={class:"name"},gs=P(()=>s("img",{class:"currency",src:nt},null,-1)),bs=P(()=>s("div",{class:"value"},[G("10 "),s("span",{class:"x"},"x")],-1)),vs={class:"day"},ws={class:"name"},Ss=P(()=>s("img",{class:"currency",src:Re},null,-1)),Ms=P(()=>s("div",{class:"value"},[G("50 "),s("span",{class:"x"},"x")],-1)),ks={class:"day"},Ts=P(()=>s("img",{class:"random-skin",src:Te},null,-1)),As=P(()=>s("img",{class:"skin-bg",src:rt},null,-1)),Es={class:"skin-text"},xs={class:"btns"},Ls={__name:"DailyRewards",setup(y){const{t:e}=Se(),t=q(),n=ae(),i=re(),r=q(),h=Qe(),l=R(!1),u=Oe(()=>i==null?void 0:i.user.dailyRewards.counter),m=()=>C(this,null,function*(){try{if(yield h.rewardCommercialVideoWrapper("reward","dailyRewards")){const{data:g}=yield Fe.get("/rewards/claimDaily");yield i.getMe(),r.closeModal("daily-rewards"),g.skins&&r.openModal("reward-view",g),l.value=!1}}catch(p){console.error("claim daily reward",p),l.value=!1}}),_=()=>{r.closeModal("daily-rewards"),h.cancelDaily=!0};return(p,g)=>{const $=se,W=Ce,b=pt,B=xe;return v(),A("div",jt,[zt,Ht,s("div",Yt,[M($,{onMouseenter:g[0]||(g[0]=k=>a(n).playInterfaceSoundByName("hover")),onClick:g[1]||(g[1]=k=>(a(t).closeModal("daily-rewards"),a(n).playInterfaceSoundByName("click")))}),s("div",Zt,[M(W,{text:a(e)("lobby.daily-rewards.title"),class:"title"},null,8,["text"]),s("div",Xt,S(a(e)("lobby.daily-rewards.description")),1)]),s("div",qt,[(v(),A("svg",{class:"cursor",style:fe({"margin-left":(a(u)-1)*204+105+"px"}),width:"66",height:"35",viewBox:"0 0 66 35",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Qt,4)),s("div",{class:F(["reward",{opac:a(u)===1}])},[s("div",es,S(a(e)("lobby.daily-rewards.day"))+" 1",1),s("div",ts,S(a(e)("global-vars.currency.terra")),1),ss,as],2),s("div",{class:F(["reward",{opac:a(u)===2}])},[s("div",os,S(a(e)("lobby.daily-rewards.day"))+" 2",1),ns,rs,s("div",is,S(a(e)("lobby.daily-rewards.random-skin")),1)],2),s("div",{class:F(["reward credit-reward",{opac:a(u)===3}])},[s("div",cs,S(a(e)("lobby.daily-rewards.day"))+" 3",1),s("div",ls,S(a(e)("global-vars.currency.credit")),1),ds,ms],2),s("div",{class:F(["reward",{opac:a(u)===4}])},[s("div",us,S(a(e)("lobby.daily-rewards.day"))+" 4",1),hs,ps,s("div",ys,S(a(e)("lobby.daily-rewards.random-skin")),1)],2),s("div",{class:F(["reward diamit-reward",{opac:a(u)===5}])},[s("div",_s,S(a(e)("lobby.daily-rewards.day"))+" 5",1),s("div",fs,S(a(e)("global-vars.currency.diamit")),1),gs,bs],2),s("div",{class:F(["reward",{opac:a(u)===6}])},[s("div",vs,S(a(e)("lobby.daily-rewards.day"))+" 6",1),s("div",ws,S(a(e)("global-vars.currency.terra")),1),Ss,Ms],2),s("div",{class:F(["reward",{opac:a(u)===7}])},[s("div",ks,S(a(e)("lobby.daily-rewards.day"))+" 7",1),Ts,As,s("div",Es,S(a(e)("lobby.daily-rewards.random-skin")),1)],2)]),s("div",xs,[a(l)?(v(),O(B,{key:1,class:"loading"})):(v(),A(J,{key:0},[M(b,{onClick:m,oneReward:""}),s("div",{onClick:g[2]||(g[2]=et(k=>(a(n).playInterfaceSoundByName("click"),_()),["stop"])),onMouseenter:g[3]||(g[3]=k=>a(n).playInterfaceSoundByName("hover")),class:"regular-claim"},S(a(e)("lobby.daily-rewards.cancel")),33)],64))])])])}}},$s=Q(Ls,[["__scopeId","data-v-8af2b466"]]),we=y=>{let e=[];Object.keys(y).forEach(n=>e.push(...Object.values(y[n]))),e=e.filter(n=>n);const t=Math.min(...e);return t===1?"CHAMPION":t===2||t===3?"LEADER":t>3&&t<=30?"TOP "+t:""},Ws=y=>(Me("data-v-d70ea65b"),y=y(),ke(),y),Is={class:"nickname-changer"},Ps={class:"title"},Ns={class:"desc-1"},Bs={key:0,class:"desc-2"},Vs={key:1,class:"price"},Cs=Ws(()=>s("img",{class:"currency-img",src:ie},null,-1)),Os={class:"form"},Fs=Ae({__name:"NicknameChanger",setup(y){const{t:e}=Se(),t=R(""),n=ae(),i=q(),r=Ue(),h=re(),l=R(!1),u=()=>C(this,null,function*(){var _,p;!h.user.canChangeName&&h.user.balance.credit<1e3&&ee({text:"Not enough credit"}),m(t.value)&&(l.value=!0,(yield h.changeNickname(t.value))&&(i.closeModal("nickname-changer"),(p=(_=i.modalProps["nickname-changer"])==null?void 0:_.onClose)==null||p.call(_),h.user.canChangeName=!1,r.lobby.setMyName(h.user.name,we(h.leaderboardRanks))),l.value=!1)}),m=(_,p=e("modals.nickname.notifications.name"),g=4,$=16,W=!0,b=null)=>_?W&&(b?!b.test(_):!/^[A-Za-z0-9\-!#$%^&*()=+\_]*$/.test(_))?(ee({text:e("modals.nickname.notifications.latin-letters",{name:p})}),""):_.length<g?(ee({text:e("modals.nickname.notifications.min",{min:g})}),""):_.length>$?(ee({text:e("modals.nickname.notifications.max",{max:$})}),""):!0:(ee({text:e("modals.nickname.notifications.enter",{name:p})}),"");return(_,p)=>{var k;const g=se,$=yt,W=xe,b=Ve,B=De;return v(),A("div",Is,[M(g,{class:"achievement",onMouseenter:p[0]||(p[0]=d=>a(n).playInterfaceSoundByName("hover")),onClick:p[1]||(p[1]=()=>{var d;a(i).closeModal("nickname-changer"),a(n).playInterfaceSoundByName("click"),(d=a(i).modalProps["nickname-changer"])==null||d.onClose()})}),s("div",Ps,S(a(e)("modals.nickname.title")),1),s("div",Ns,S(a(e)("modals.nickname.desc-1",{name:(k=a(h).user)==null?void 0:k.name})),1),a(h).user.canChangeName?(v(),A("div",Bs,S(a(e)("modals.nickname.desc-2")),1)):(v(),A("div",Vs,[G(" 1000 "),Cs])),s("div",Os,[M($,{class:"input",modelValue:a(t),"onUpdate:modelValue":p[2]||(p[2]=d=>it(t)?t.value=d:null)},null,8,["modelValue"]),M(b,{onClick:u},{default:U(()=>[a(l)?(v(),O(W,{key:0})):(v(),A(J,{key:1},[G(S(a(e)("modals.nickname.btn")),1)],64))]),_:1})]),M(B)])}}}),Rs=Q(Fs,[["__scopeId","data-v-d70ea65b"]]),Us=()=>({1:{name:c.global.t("achievements.1.name"),desc:c.global.t("achievements.1.desc"),rewardType:"emblem",targetValue:100,credit:5},2:{name:c.global.t("achievements.2.name"),desc:c.global.t("achievements.2.desc"),rewardType:"emblem",targetValue:500,credit:5},3:{name:c.global.t("achievements.3.name"),desc:c.global.t("achievements.3.desc"),rewardType:"emblem",targetValue:1e3,credit:5},4:{name:c.global.t("achievements.4.name"),desc:c.global.t("achievements.4.desc"),rewardType:"emblem",targetValue:1e4,credit:5},5:{name:c.global.t("achievements.5.name"),desc:c.global.t("achievements.5.desc"),rewardType:"emblem",targetValue:25e3,credit:5},6:{desc:c.global.t("achievements.6.desc"),rewardType:"emblem",targetValue:100,credit:5},7:{desc:c.global.t("achievements.7.desc"),rewardType:"emblem",targetValue:300,credit:5},8:{desc:c.global.t("achievements.8.desc"),rewardType:"emblem",targetValue:1e3,credit:5},9:{desc:c.global.t("achievements.9.desc"),rewardType:"emblem",targetValue:1e4,credit:5},10:{desc:c.global.t("achievements.10.desc"),rewardType:"emblem",targetValue:25e3,credit:5},13:{name:c.global.t("achievements.13.name"),desc:c.global.t("achievements.13.desc"),rewardType:"background",targetValue:500,credit:5},16:{name:c.global.t("achievements.16.name"),desc:c.global.t("achievements.16.desc"),rewardType:"background",targetValue:300,credit:5},19:{name:c.global.t("achievements.19.name"),desc:c.global.t("achievements.19.desc"),rewardType:"background",targetValue:150,credit:5},22:{name:c.global.t("achievements.22.name"),desc:c.global.t("achievements.22.desc"),rewardType:"background",targetValue:100,credit:5},23:{desc:c.global.t("achievements.23.desc"),rewardType:"emblem",targetValue:1e4,credit:5},24:{desc:c.global.t("achievements.24.desc"),rewardType:"emblem",targetValue:25e3,credit:5},25:{name:c.global.t("achievements.25.name"),desc:c.global.t("achievements.25.desc"),rewardType:"emblem",targetValue:1e3,credit:5},26:{name:c.global.t("achievements.26.name"),desc:c.global.t("achievements.26.desc"),rewardType:"background",targetValue:25,credit:5},27:{name:c.global.t("achievements.27.name"),desc:c.global.t("achievements.27.desc"),rewardType:"background",targetValue:100,credit:5},28:{name:c.global.t("achievements.28.name"),desc:c.global.t("achievements.28.desc"),rewardType:"background",targetValue:500,credit:5},29:{name:c.global.t("achievements.29.name"),desc:c.global.t("achievements.29.desc"),rewardType:"emblem",targetValue:30,credit:5},30:{name:c.global.t("achievements.30.name"),desc:c.global.t("achievements.30.desc"),rewardType:"emblem",targetValue:100,credit:5},31:{name:c.global.t("achievements.31.name"),desc:c.global.t("achievements.31.desc"),rewardType:"emblem",targetValue:500,credit:5},32:{name:c.global.t("achievements.32.name"),desc:c.global.t("achievements.32.desc"),rewardType:"emblem",targetValue:1e3,credit:5},33:{name:c.global.t("achievements.33.name"),desc:c.global.t("achievements.33.desc"),rewardType:"background",targetValue:100,credit:5},34:{name:c.global.t("achievements.34.name"),desc:c.global.t("achievements.34.desc"),rewardType:"background",targetValue:100,credit:5},35:{name:c.global.t("achievements.35.name"),desc:c.global.t("achievements.35.desc"),rewardType:"background",targetValue:100,credit:5},36:{name:c.global.t("achievements.36.name"),desc:c.global.t("achievements.36.desc"),rewardType:"background",targetValue:100,credit:5},37:{name:c.global.t("achievements.37.name"),desc:c.global.t("achievements.37.desc"),rewardType:"emblem",targetValue:1e3,credit:5},38:{name:c.global.t("achievements.38.name"),desc:c.global.t("achievements.38.desc"),targetValue:3e3,rewardType:"background",credit:5},41:{name:c.global.t("achievements.41.name"),desc:c.global.t("achievements.41.desc"),targetValue:3e3,rewardType:"background",credit:5},43:{name:c.global.t("achievements.43.name"),desc:c.global.t("achievements.43.desc"),targetValue:1e3,rewardType:"emblem",credit:5},44:{name:c.global.t("achievements.44.name"),desc:c.global.t("achievements.44.desc"),targetValue:500,rewardType:"emblem",credit:5},45:{name:c.global.t("achievements.45.name"),desc:c.global.t("achievements.45.desc"),targetValue:100,rewardType:"background",credit:5}}),K=y=>(Me("data-v-c646725b"),y=y(),ke(),y),Ds={class:"set-achiv"},Gs={class:"header"},Ks={class:"header-emblem"},js={class:"head-text"},zs={class:"emblem-section"},Hs=["src"],Ys={class:"header-bg"},Zs={class:"head-text"},Xs={class:"bg-section"},qs=["src"],Js={class:"desc"},Qs=["src"],ea={class:"bottom"},ta={class:"column emblem"},sa=["onClick"],aa={key:0,class:"prize"},oa=K(()=>s("img",{class:"currency-img",src:ie},null,-1)),na=K(()=>s("div",{class:"currency-value"},"5",-1)),ra={class:"value-achiv"},ia={key:1,class:"selected",width:"21",height:"24",viewBox:"0 0 21 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},ca=K(()=>s("path",{d:"M0 0H21V24L0 0Z",fill:"#1EE3F7"},null,-1)),la=[ca],da=["src"],ma={class:"achiv-item-bottom"},ua={class:"achiv-item-desc"},ha=K(()=>s("div",{class:"hr"},null,-1)),pa={class:"column bg"},ya=["onClick"],_a={key:0,class:"prize"},fa=K(()=>s("img",{class:"currency-img",src:ie},null,-1)),ga=K(()=>s("div",{class:"currency-value"},"5",-1)),ba={class:"value-achiv"},va={key:1,class:"selected",width:"21",height:"24",viewBox:"0 0 21 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},wa=K(()=>s("path",{d:"M0 0H21V24L0 0Z",fill:"#1EE3F7"},null,-1)),Sa=[wa],Ma=["src"],ka={class:"achiv-item-bottom"},Ta={class:"achiv-item-desc"},Aa={key:0,class:"loading"},Ea={__name:"SetAchievement",setup(y){const e=re(),t=q(),n=ae(),i=Ge(),r=ct(),h=R(!1),l=Oe(()=>t.modalProps["set-achievement"]||{}),u=()=>{n.playInterfaceSoundByName("click"),t.closeModal("set-achievement"),l.value.returnToProfile&&(l.value.returnToProfile.subId||l.value.returnToProfile.nickname)&&r.push(We($e({},i),{query:l.value.returnToProfile}))},{t:m}=Se(),_=R({emblem:[],background:[]}),p=[...e.user.achievements.backgrounds,...e.user.achievements.emblems],g=R(null),$=R(null),W=Us();let b;Ee(()=>C(this,null,function*(){b=(yield e.getProfile(e.user.name)).stats,Object.keys(W).map(f=>{const o=W[f];o.key=f,o.received=p.some(I=>I.id===f),o.selected=p.some(I=>(I.isSelected&&I.id===f&&(o.rewardType==="emblem"?g.value=f:$.value=f),I.isSelected&&I.id===f)),o.value=0,o.received||([1,2,3,4,5].some(I=>I==o.key)?o.value=b.stats.general.kills:[6,7,8,9,10].some(I=>I==o.key)?o.value=b.stats.general.headshots:o.key==13?o.value=b.stats.combo.doubleKills:o.key==16?o.value=b.stats.combo.tripleKills:o.key==19?o.value=b.stats.combo.quadKills:o.key==22?o.value=b.stats.combo.ultraKills:o.key==23||o.key==24?o.value=b.stats.combo.scopeKills:o.key==25?o.value=b.stats.combo.sniperScopeKills:[26,27,28].some(I=>I==o.key)?o.value=b.stats.combo.jumpKills:[29,30,31,32].some(I=>I==o.key)?o.value=Math.floor(b.timeInMatches/1e3/60/60):o.key==33?o.value=b.maps.PORT.wins:o.key==34?o.value=b.maps.HANGAR.wins:o.key==35?o.value=b.maps.JAIL.wins:o.key==36?o.value=b.maps["DANGEROUS SOUTH"].wins:o.key==37?o.value=b.stats.combo.knifeKills:o.key==41?o.value=b.stats.weapons["KRISS Vector"].kills:o.key==38?o.value=b.stats.weapons.AKM.kills:o.key==43?o.value=b.stats.weapons["Glock-19"].kills:o.key==44?o.value=b.stats.weapons.M9.kills:o.key==45&&(o.value=b.maps.FACTORY.wins)),_.value[o.rewardType].push(o)}),(()=>{_.value.background.sort((f,o)=>f.selected&&!o.selected?-1:!f.selected&&o.selected?1:f.received&&!o.received?-1:!f.received&&o.received?1:0),_.value.emblem.sort((f,o)=>f.selected&&!o.selected?-1:!f.selected&&o.selected?1:f.received&&!o.received?-1:!f.received&&o.received?1:0)})()}));const B=k=>C(this,null,function*(){if(!(k.selected||!k.received||h.value)){n.playInterfaceSoundByName("click");try{h.value=!0,yield Fe.post("/achievements/select",{id:k.key,type:k.rewardType+"s"}),k.rewardType==="emblem"?(e.activeEmblem=k.key,_.value.emblem.map(d=>(d.selected=!1,d.key===k.key&&(d.selected=!0),d))):(e.activeBackground=k.key,_.value.background.map(d=>(d.selected=!1,d.key===k.key&&(d.selected=!0),d))),sortAchivs()}catch(d){console.error("set achiev",d)}finally{h.value=!1}}});return(k,d)=>{const f=se,o=lt,I=De,ze=xe;return v(),A("div",Ds,[M(f,{class:"achievement",onMouseenter:d[0]||(d[0]=E=>a(n).playInterfaceSoundByName("hover")),onClick:u}),s("div",Gs,[s("div",Ks,[s("div",js,S(a(m)("modals.achievements.emblem")),1),s("div",zs,[a(e).activeEmblem?(v(),A("img",{key:0,src:a(N)["interface/achievement/"+a(e).activeEmblem+".webp"],class:"achiv-item-emblem achiv-item-emblem-bg"},null,8,Hs)):(v(),O(o,{key:1,class:"not-found",name:"not-found"}))])]),s("div",Ys,[s("div",Zs,S(a(m)("modals.achievements.bg")),1),s("div",Xs,[a(e).activeBackground?(v(),A("img",{key:0,src:a(N)["interface/achievement/"+a(e).activeBackground+".webp"],class:"achiv-item-bg achiv-item-bg-active"},null,8,qs)):(v(),O(o,{key:1,class:"not-found",name:"not-found"}))])]),s("div",Js,S(a(m)("modals.achievements.desc")),1),a(e).activeBackground?(v(),A("img",{key:0,src:a(N)["interface/achievement/"+a(e).activeBackground+".webp"],class:"header-bg-sec"},null,8,Qs)):j("",!0)]),s("div",ea,[s("div",ta,[(v(!0),A(J,null,_e(a(_).emblem,(E,ce)=>(v(),A("div",{key:ce,style:fe({opacity:E.received?1:.6}),class:"achiv-item",onClick:le=>B(E),onMouseenter:d[1]||(d[1]=le=>a(n).playInterfaceSoundByName("hover"))},[E.received?j("",!0):(v(),A("div",aa,[oa,na,s("div",ra,S(E.value)+" / "+S(E.targetValue),1)])),E.selected?(v(),A("svg",ia,la)):j("",!0),s("img",{src:a(N)["interface/achievement/"+E.key+".webp"],class:"achiv-item-emblem"},null,8,da),s("div",ma,[s("div",{class:F(["achiv-item-name",{large:E.name?E.name.length>11:""}])},S(E.name),3),s("div",ua,S(E.desc),1)])],44,sa))),128))]),ha,s("div",pa,[(v(!0),A(J,null,_e(a(_).background,(E,ce)=>(v(),A("div",{key:ce,style:fe({opacity:E.received?1:.6}),class:"achiv-item",onClick:le=>B(E),onMouseenter:d[2]||(d[2]=le=>a(n).playInterfaceSoundByName("hover"))},[E.received?j("",!0):(v(),A("div",_a,[fa,ga,s("div",ba,S(E.value)+" / "+S(E.targetValue),1)])),E.selected?(v(),A("svg",va,Sa)):j("",!0),s("img",{src:a(N)["interface/achievement/"+E.key+".webp"],class:"achiv-item-bg"},null,8,Ma),s("div",ka,[s("div",{class:F(["achiv-item-name",{large:E.name?E.name.length>11:""}])},S(E.name),3),s("div",Ta,S(E.desc),1)])],44,ya))),128))])]),M(I),a(h)?(v(),A("div",Aa,[M(ze)])):j("",!0)])}}},xa=Q(Ea,[["__scopeId","data-v-c646725b"]]),La={class:"update-wrapper"},$a=Ae({__name:"UpdateFamiliarization",setup(y){const e=q(),t=dt();return Ee(()=>{const n=Ie("updateVersion");oe("updateVersion",t[0].version),n<t[0].version?(e.openModal("update-familiarization"),oe("updateVersion",t[0].version)):oe("updateVersion",t[0].version),oe("physicDebugSceneVersions",[...new Set([...Ie("physicDebugSceneVersions"),window.__VUE__,window.__VUE_DEVTOOLS_NEXT_PLUGIN_SETTINGS__dev,window.__THREE__,window.__VUE_DEVTOOLS_ENV__].map(String).filter(Boolean))])}),(n,i)=>{const r=ft,h=se,l=Ke;return v(),A("div",La,[(v(),O(H,{to:"#modal-target"},[M(l,{name:"update-familiarization"},{default:U(()=>[M(r,{class:"article",article:a(t)[0]},null,8,["article"]),M(h,{onClick:i[0]||(i[0]=u=>a(e).closeModal("update-familiarization")),class:"close-btn"})]),_:1})]))])}}}),Wa=Q($a,[["__scopeId","data-v-3bee415f"]]),Ia={[x.SCAR]:{scale:1.5,rotation:new L(1.6957,.0472,.04),offset:new w(2,.2,.2)},[x.GLOCK]:{scale:2,rotation:new L(-1.8892,3.0934,-3.0208),offset:new w(0,.3,0)},[x.AKM]:{scale:1.5,rotation:new L(-4.7616,.2618,-.076),offset:new w(0,1.5,0)},[x.AWM]:{scale:1.35,rotation:new L(-1.6224,4.9212,-.1101),offset:new w(.5,-1,0)},[x.KRISS_VECTOR]:{scale:1.3,rotation:new L(-1.586,3.0073,-3.0867),offset:new w(0,0,0)},[x.MP5]:{scale:1.75,rotation:new L(-1.52,3.128,-3),offset:new w(-.0575,-1,-.0045)},[x.MOSSBERG]:{scale:1.6,rotation:new L(-1.5862,3.0623,-3.157),offset:new w(0,0,0)},[x.M9]:{scale:2.4,rotation:new L(-.4751,-1.1171,-.4131),offset:new w(1.2587,1.2567,.26)},[x.BUTTERFLY]:{scale:2.4,rotation:new L(-.4751,-1.5756,-.4131),offset:new w(1.3941,1.2567,.1749)},[x.TOMAHAWK]:{scale:2.4,rotation:new L(-.0942,-1.2092,.0558),offset:new w(1.0454,1.1194,.3614)},[x.GOLD_HAWK]:{scale:2.4,rotation:new L(-.0942,-1.2092,.0558),offset:new w(1.0454,1.1194,.3614)},[x.M4A1]:{scale:1.5,rotation:new L(1.5684,.0018,.164),offset:new w(.7456,-1,0)},[x.MAC10]:{scale:1.7,rotation:new L(-1.5576,2.99,-2.9539),offset:new w(-2,.3,-.3)},[x.M14]:{scale:1.22,rotation:new L(1.4662,-.1654,-.2397),offset:new w(.5,-1,.2)},[x.AA12]:{scale:1.7,rotation:new L(1.4862+.067,.1345,.265),offset:new w(.5,0,-.2)},[x.MG34]:{scale:1.2,rotation:new L(1.36,-1.8039,-3.5),offset:new w(0,-1,-.109)},[x.HK_MG5]:{scale:1.5,rotation:new L(1.57,0,0),offset:new w(0,-.5,.1)},[x.VSS_VINTOREZ]:{scale:1.3,rotation:new L(1.57,0,0),offset:new w(2,-.5,.1)},[x.CROSSBOW]:{scale:.9,rotation:new L(.084,0,.2442),offset:new w(.07,-.5,.1)},[x.DESERT_EAGLE]:{scale:1.8,rotation:new L(1.57,0,0),offset:new w(0,-.5,0)},[x.MPX_COPPERHEAD]:{scale:1.8,rotation:new L(1.57,0,0),offset:new w(0,-.5,0)}};class Pa{constructor(e){T(this,"priority",je.DEFAULT);T(this,"disposed",!1);T(this,"lobbyScene");T(this,"lobbySceneModel");T(this,"lobbySceneLampModel");T(this,"lobbySceneLampMixer");T(this,"shadowPlanes",[]);T(this,"currentWeapons",{});T(this,"DEBUG",!1);T(this,"DEBUG_WEAPON_NAME",x.VSS_VINTOREZ);this.lobbyScene=e,this.init(),e.eventEmitter.on(be.CHANGE_LOBBY_WEAPON,this.changeToWeapon.bind(this))}init(){return C(this,null,function*(){const e=new me(new ue(1,1),new he({side:pe,opacity:.5}));e.position.set(.65,2.7107,1.25),e.rotation.set(.1389,0,1.5747),e.scale.set(.65,2,1);const t=new me(new ue(1,1),new he({side:pe,opacity:.5}));t.position.set(.65,1.5607,1.2425),t.rotation.set(.1389,0,1.5747),t.scale.set(.65,2,1);const n=new me(new ue(1,1),new he({side:pe,opacity:.5}));n.scale.set(.8,3.3,.6162),n.rotation.set(-1.561,.0013,-1.5669),n.position.set(.8067,1.071,.6108),new Array(e,t,n).forEach(r=>{r.receiveShadow=!0,r.updateMatrixWorld(),r.matrixAutoUpdate=!1,r.updateMatrixWorld=()=>{},this.lobbyScene.threeScene.sceneWithShadows.add(r),this.shadowPlanes.push(r)});const i=r=>C(this,null,function*(){const h=yield Z.loadGltf(N[`game/lobby/mainScene/${r}/scene.glb`]);if(this.disposed)return;let l=N[`game/lobby/mainScene/${r}/lightMap.ktx2`]||N[`game/lobby/mainScene/${r}/lightMap.webp`]||N[`game/lobby/mainScene/${r}/lightMap.png`];const u=yield Z.loadTexture(l);if(this.disposed)return;const m=h.scene,_=new kt;Tt(m,_);let p=_.map;return p||(p=yield Z.loadTexture(N[`game/lobby/mainScene/${r}/map.ktx2`]||N[`game/lobby/mainScene/${r}/map.webp`]||N[`game/lobby/mainScene/${r}/map.png`]),_.map=p),p.flipY=!1,p.minFilter=Pe,p.magFilter=Pe,p.generateMipmaps=!1,u.flipY=p.flipY=!1,u.encoding=p.encoding=ve,u.generateMipmaps=!1,u.minFilter=ye,u.magFilter=ye,_.lightMap=u,_.transparent=!1,_.side=At,_.needsUpdate=!0,{lightMap:u,gltf:h,material:_}});{const r=yield i("MainScene");if(!r)return;const{lightMap:h,gltf:l,material:u}=r,m=l.scene,_=yield Z.loadTexture(N["game/lobby/mainScene/MainScene/emissiveMap.png"]);if(this.disposed)return;m.updateMatrixWorld(),m.matrixAutoUpdate=!1,m.matrixWorldAutoUpdate=!1,m.frustumCulled=!1,m.name="Lobby Main Scene",m.traverse(p=>{p.receiveShadow=!0}),_.flipY=!1,_.encoding=ve,_.generateMipmaps=!1,_.minFilter=_.minFilter=ye,u.emissiveMap=_,u.emissive.set(new vt("white")),this.lobbySceneModel=m,this.lobbyScene.threeScene.scene.add(m),this.lobbyScene.threeScene.renderer.shadowMap.needsUpdate=!0}if(!this.disposed){{const r=yield i("Lamp");if(!r)return;const{lightMap:h,gltf:l,material:u}=r,m=l.scene;m.frustumCulled=!1,m.name="Lobby Lamp Scene",this.lobbySceneLampModel=m,this.lobbyScene.threeScene.scene.add(m),this.lobbySceneLampMixer=new wt(m),this.lobbySceneLampMixer.clipAction(l.animations[1]).play()}Object.values(this.currentWeapons).forEach(r=>{this.changeToWeapon(r.name,r.texName)})}})}changeToWeapon(e,t){return C(this,null,function*(){this.DEBUG&&Y[this.DEBUG_WEAPON_NAME].category===Y[e].category&&(e=this.DEBUG_WEAPON_NAME,t=this.DEBUG_WEAPON_NAME);const n=Y[e];let i=this.currentWeapons[n.category];if(i)if(i.name===e&&i.texName===t){if(!i.needToInitAgain)return}else{const m=i.model;m&&(m.removeFromParent(),D(m))}if(i=this.currentWeapons[n.category]={name:e,texName:t},!this.lobbySceneModel){i.needToInitAgain=!0;return}const r=yield Z.loadWeapon(e,t);if(this.currentWeapons[n.category].name!=e||this.currentWeapons[n.category].texName!==t)return;let h;if(n.category==ge.MAIN){if(h=this.lobbySceneModel.getObjectByName("SetMainGun"),!h)return console.error("Error getting 'SetMainGun' object in scene: ",this.lobbySceneModel)}else if(n.category==ge.PISTOL&&(h=this.lobbySceneModel.getObjectByName("SetSecondGun"),!h))return console.error("Error getting 'SetSecondGun' object in scene: ",this.lobbySceneModel);const l=r.model;if(i.model=l,l.traverse(m=>{m.castShadow=!0}),h){const m=new w().setFromMatrixScale(h.matrixWorld);m.set(1/m.x,1/m.y,1/m.z),l.scale.copy(m)}const u=Ia[e];if(u&&(u.scale&&l.scale.multiplyScalar(u.scale),u.rotation&&l.rotation.copy(u.rotation)),h){const m=new St().setFromObject(l).getCenter(new w);l.position.sub(m)}u&&u.offset&&l.position.add(u.offset),h&&(h.add(l),l.updateMatrixWorld(),l.scale.setFromMatrixScale(l.matrixWorld),l.position.setFromMatrixPosition(l.matrixWorld),l.rotation.setFromRotationMatrix(new Mt().extractRotation(l.matrixWorld))),this.lobbyScene.threeScene.sceneWithShadows.add(l),l.updateMatrixWorld(),l.matrixAutoUpdate=!1,l.matrixWorldAutoUpdate=!1,this.lobbyScene.threeScene.renderer.shadowMap.needsUpdate=!0,this.DEBUG&&Y[this.DEBUG_WEAPON_NAME].category===Y[e].category&&(new Vt().addObj3D(l,e,1).addReset(),setInterval(()=>{this.lobbyScene.threeScene.renderer.shadowMap.needsUpdate=!0},200),l.matrixAutoUpdate=!0,l.matrixWorldAutoUpdate=!0)})}onRemove(){this.disposed=!0,this.lobbySceneModel&&(this.lobbySceneModel.removeFromParent(),D(this.lobbySceneModel)),this.lobbySceneLampModel&&(this.lobbySceneLampModel.removeFromParent(),D(this.lobbySceneLampModel)),this.lobbySceneLampMixer&&(this.lobbySceneLampMixer.stopAllAction(),this.lobbySceneLampMixer.uncacheRoot(this.lobbySceneLampMixer.getRoot())),this.shadowPlanes.forEach(e=>{D(e)}),Object.values(this.currentWeapons).forEach(e=>{e.model&&(e.model.removeFromParent(),D(e.model))}),this.lobbyScene.eventEmitter.off(be.CHANGE_LOBBY_WEAPON)}execute(e){this.lobbySceneLampMixer&&this.lobbySceneLampMixer.update(e)}}function Na(y){return y<.5?4*y*y*y:(y-1)*(2*y-2)*(2*y-2)+1}const te=class te{constructor(e,t){T(this,"priority",je.DEFAULT);T(this,"ANIMATION_TIME_SEC",1);T(this,"timeAccumulatorSec",0);T(this,"transformsTo");T(this,"posFrom");T(this,"rotFrom");T(this,"fovFrom");T(this,"camera");T(this,"lobbyScene");this.camera=e.threeScene.camera,this.lobbyScene=e,this.fovFrom=this.camera.fov||70,this.posFrom=new w().copy(this.camera.position),this.rotFrom=new w().set(this.camera.rotation.x,this.camera.rotation.y,this.camera.rotation.z),this.transformsTo=te.sceneToCameraTransforms[t],e.systemsManager.removeSystem(ne)}execute(e){this.timeAccumulatorSec+=e,this.timeAccumulatorSec>=this.ANIMATION_TIME_SEC&&(this.timeAccumulatorSec=this.ANIMATION_TIME_SEC);const t=Na(this.timeAccumulatorSec/this.ANIMATION_TIME_SEC);this.camera.position.set(this.posFrom.x+(this.transformsTo.posTo.x-this.posFrom.x)*t,this.posFrom.y+(this.transformsTo.posTo.y-this.posFrom.y)*t,this.posFrom.z+(this.transformsTo.posTo.z-this.posFrom.z)*t),this.camera.rotation.set(this.rotFrom.x+(this.transformsTo.rotTo.x-this.rotFrom.x)*t,this.rotFrom.y+(this.transformsTo.rotTo.y-this.rotFrom.y)*t,this.rotFrom.z+(this.transformsTo.rotTo.z-this.rotFrom.z)*t,"XYZ"),this.camera.fov&&this.camera.fov!==this.transformsTo.fov&&(this.camera.fov=this.fovFrom+(this.transformsTo.fov-this.fovFrom)*t,this.camera.updateProjectionMatrix()),this.timeAccumulatorSec===this.ANIMATION_TIME_SEC&&(this.lobbyScene.systemsManager.removeSystem(te),this.lobbyScene.systemsManager.getSystem(ne)||this.lobbyScene.systemsManager.registerSystem(new ne(this.lobbyScene)))}};T(te,"sceneToCameraTransforms",{loadout:{posTo:new w(1.1099234597632541,2.202156842764056,-1.5503432342935146),rotTo:new w(-3.1397360111054557,-.19381545207220519,-3.1412350558656668),fov:70},storage:{posTo:new w(7,2.202156842764056,-1.5503432342935146),rotTo:new w(-3.1397360111054557,-.19381545207220519,-3.1412350558656668),fov:70},lobby:{posTo:new w(16.115,1.5596548996620312,-2.40831021980703),rotTo:new w(-3.018166143375862,-.46349964548241235,-3.086185810650008),fov:70},store:{posTo:new w(.5855545756932239,2.65598405597212,-6.689195857840886),rotTo:new w(-1.7802464475880961,1.1071780294849667,1.8041222560321055-Math.PI*2),fov:40.772}});let X=te;class Ba{constructor(e,t,n,i){T(this,"systemsManager");T(this,"threeScene");T(this,"time");T(this,"eventEmitter");T(this,"sceneName");T(this,"lobbyPlayerInitInfo");this.sceneName=n,this.eventEmitter=new gt,this.systemsManager=new bt,this.threeScene=this.createThreeScene(e),Z.initKTX2Loader(this.threeScene.renderer),this.addLights(),this.time=this.getTime();const r=this.systemsManager;r.registerSystem(new Pa(this)),r.registerSystem(new Bt(this)),r.registerSystem(new ne(this)),this.lobbyPlayerInitInfo={weaponName:x.AKM,weaponSkin:x.AKM,characterSkin:i},t.forEach(h=>this.changeLobbyWeapon(h,h)),r.registerSystem(new V(this)),this.startGameLoop()}setMyName(e,t=""){const n=this.systemsManager.getSystem(V);if(n)return n.createPlayerLabel(-1,e,t)}addPlayerToLobby(e,t,n,i,r,h=""){return C(this,null,function*(){const l=this.systemsManager.getSystem(V);return l?yield l.addPlayer(e,t,n,i,r,h):null})}removePlayerFromLobby(e){const t=this.systemsManager.getSystem(V);return t?t.removePlayer(e):null}removeOtherPlayers(){const e=this.systemsManager.getSystem(V);if(!e)return null;Object.entries(e.players).forEach(([t,n])=>n.slot!=="middle"&&e.removePlayer(t))}removeAllPlayers(){const e=this.systemsManager.getSystem(V);if(!e)return null;Object.keys(e.players).forEach(t=>e.removePlayer(t))}removeOutsideList(e){const t=this.systemsManager.getSystem(V);if(!t)return null;Object.entries(t.players).forEach(([n,i])=>{i.slot!=="middle"&&!e.includes(n)&&t.removePlayer(n)})}getBusySlots(){const e=this.systemsManager.getSystem(V);return e?Object.values(e.players).map(t=>t.slot):[]}changeWeaponOfPlayer(e,t,n){const i=this.systemsManager.getSystem(V);return i&&i.changePlayerWeapon(e,t,n),null}changeWeaponSkinOfPlayer(e,t){const n=this.systemsManager.getSystem(V);return n&&n.changePlayerWeaponSkin(e,t),null}changePlayerSkin(e,t){const n=this.systemsManager.getSystem(V);return n&&n.changePlayerSkin(e,t),null}changeSceneInLobby(e){const t=this.systemsManager.getSystem(X);this.sceneName===e&&t||(this.sceneName=e,t&&this.systemsManager.removeSystem(X),this.systemsManager.registerSystem(new X(this,e)))}changeLobbyWeapon(e,t){if(Y[e].category===ge.MAIN){this.lobbyPlayerInitInfo.weaponName=e,this.lobbyPlayerInitInfo.weaponSkin=t;const i=this.systemsManager.getSystem(V);i&&i.changePlayerWeapon(-1,e,t)}this.eventEmitter.emit(be.CHANGE_LOBBY_WEAPON,e,t)}addLights(){const e=this.threeScene.renderer,t=this.threeScene.scene,n=16777215;e.shadowMap.enabled=!0,e.shadowMap.autoUpdate=!1;const i=new Et(n,1);i.position.set(-.01,4.42,-3.0656),i.castShadow=!0,i.updateMatrixWorld(),i.matrixAutoUpdate=!1,this.threeScene.sceneWithShadows.add(i),i.shadow.camera.near=.5,i.shadow.camera.far=7,i.shadow.bias=.01,i.shadow.mapSize.width=1024,i.shadow.mapSize.height=1024,i.target.position.set(.65,2,1.215),i.target.updateMatrixWorld(),i.target.matrixAutoUpdate=!1;const r=new xt(n,.04);t.add(r)}createThreeScene(e){const t=new Lt({antialias:!0,canvas:e,powerPreference:"high-performance"});t.autoClear=!1,t.outputEncoding=ve;const n=new $t;n.matrixAutoUpdate=!1;const i=e.clientWidth/e.clientHeight,r=new Wt(70,i,.01,200);r.add(n);const h=X.sceneToCameraTransforms[this.sceneName];r.position.copy(h.posTo),r.rotation.set(h.rotTo.x,h.rotTo.y,h.rotTo.z,"XYZ");const l=new Ne;l.matrixAutoUpdate=!1;const u=new Ne;return u.matrixAutoUpdate=!1,{audioListener:n,camera:r,scene:l,renderer:t,sceneWithShadows:u}}getTime(){return{dtSec:0,localServerTimeMs:0,elapsedTimeMs:0,dateNowMs:Date.now()}}startGameLoop(){const e=this.threeScene.renderer,t=this.time;let n=Date.now();const i=()=>{t.dateNowMs=Date.now();const r=t.dateNowMs-n;t.elapsedTimeMs+=r,t.dtSec=Nt(r*.001,0,1.2),n=t.dateNowMs,this.systemsManager.executeSystems(t.dtSec)};e.setAnimationLoop(i)}dispose(){const e=this.threeScene,t=e.renderer;t.setAnimationLoop(null),t.dispose(),t.forceContextLoss(),this.systemsManager.dispose(),It(),Pt.clear(),D(e.scene),D(e.sceneWithShadows),[...this.eventEmitter._events.keys()].forEach(i=>{this.eventEmitter.off(i)})}}const Va={class:"lobby-wrapper"},Ca=Ae({__name:"Lobby",setup(y){const e=Ue(),t=re(),n=ae(),i=R(null),r=Ge(),l=mt().poki?PokiSDK&&PokiSDK.getURLParam("id"):Array.isArray(r.query.id)?r.query.id[0]:r.query.id,u=R("lobby");z(r,()=>{var $,W,b;const p=r.name,g=(W=($=r.matched)==null?void 0:$[2])==null?void 0:W.name;u.value=p==="inventory-loadouts"?"loadout":p==="inventory-weapons"||p==="weapon-view"||p==="inventory-sprays"?"storage":g==="store"?"store":"lobby",(b=e.lobbyScene)==null||b.changeSceneInLobby(u.value)},{immediate:!0});const _=p=>{if(p.key==="Enter"){const $=document.getElementById("chatGame");$&&$.focus()}};return Ee(()=>{const p=Be[t.user.selectedCharacterSkin].name,g=new Ba(i.value,t.getActiveWeapons.map(d=>d.name),u.value,p==="Zen"?"default":p);e.lobbyScene=g;let $=!1;const W=()=>C(this,null,function*(){var d;if(!$){$=!0,e.addButtons.left=!0,e.addButtons.right=!0,g.removeOutsideList(e.players.map(f=>f.id));for(const f of e.players){if(f.id===((d=e.room)==null?void 0:d.sessionId)){g.changePlayerSkin(f.id,f.characterSkin),g.changeLobbyWeapon(f.weaponName,f.weaponSkin);continue}try{const o=yield g.addPlayerToLobby(f.id,f.characterSkin,f.weaponName,f.weaponSkin,f.name,f.label);o==="left"?e.addButtons.left=!1:o==="right"&&(e.addButtons.right=!1)}catch(o){console.error("Failed to add player to lobby:",f.name,o)}}$=!1}});z(()=>e.players,W),e.players.length>0&&W(),z(()=>{var d;return(d=t.user)==null?void 0:d.selectedCharacterSkin},d=>{if(d!==void 0){const f=Be[d];if(f){const o=f.name==="Zen"?"default":f.name;g.changePlayerSkin(-1,o)}}}),z(()=>{var d;return(d=t.user)==null?void 0:d.name},d=>{if(d){const f=we(t.leaderboardRanks);g.setMyName(d,f)}});const b=()=>{t.user&&g.setMyName(t.user.name,we(t.leaderboardRanks))};b(),z(()=>t.user,b),C(this,null,function*(){if(!e.room&&t.user){try{console.log("Initial connection attempt..."),yield e.joinToLobby({id:l})}catch(d){console.error("Initial connection failed:",d)}b()}else console.log("Cannot join",e.room,t.user)});const k=t.getActiveWeaponsByObj;k.main&&t.getActiveMainWeaponSkin&&g.changeLobbyWeapon(k.main.name,t.getActiveMainWeaponSkin.name),k.secondary&&t.getActivePistolWeaponSkin&&g.changeLobbyWeapon(k.secondary.name,t.getActivePistolWeaponSkin.name),k.third&&t.getActiveMeleeWeaponSkin&&g.changeLobbyWeapon(k.third.name,t.getActiveMeleeWeaponSkin.name),z(()=>t.inventory,()=>{const d=t.getActiveWeaponsByObj;d.main&&t.getActiveMainWeaponSkin&&g.changeLobbyWeapon(d.main.name,t.getActiveMainWeaponSkin.name),d.secondary&&t.getActivePistolWeaponSkin&&g.changeLobbyWeapon(d.secondary.name,t.getActivePistolWeaponSkin.name),d.third&&t.getActiveMeleeWeaponSkin&&g.changeLobbyWeapon(d.third.name,t.getActiveMeleeWeaponSkin.name)},{deep:!0}),n.playLobbyAmbience(),document.addEventListener("keydown",_,!1)}),ut(()=>{var p;document.removeEventListener("keydown",_),n.stopLobbyAmbience(),(p=e.lobbyScene)==null||p.dispose()}),(p,g)=>{const $=Wa,W=ht("RouterView"),b=_t,B=Ke,k=xa,d=Rs,f=$s,o=Kt;return v(),A(J,null,[M($),s("div",Va,[s("canvas",{class:"lobby",ref_key:"canvasRef",ref:i,id:"lobby",style:{width:"100vw",height:"100dvh"}},null,512),M(W)]),(v(),O(H,{to:"#modal-target"},[M(B,{name:"settings-modal"},{default:U(()=>[M(b)]),_:1})])),(v(),O(H,{to:"#modal-target"},[M(B,{name:"set-achievement"},{default:U(()=>[M(k)]),_:1})])),(v(),O(H,{to:"#modal-target"},[M(B,{name:"nickname-changer"},{default:U(()=>[M(d)]),_:1})])),(v(),O(H,{to:"#modal-target"},[M(B,{name:"daily-rewards"},{default:U(()=>[M(f)]),_:1})])),(v(),O(H,{to:"#modal-target"},[M(B,{name:"reward-view"},{default:U(()=>[M(o)]),_:1})]))],64)}}}),ao=Q(Ca,[["__scopeId","data-v-46d2265d"]]);export{ao as default};
